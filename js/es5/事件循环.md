## Event Loop

JavaScript 事件循环机制分为浏览器和 Node 事件循环机制，两者的实现技术不一样，浏览器 Event Loop 是 HTML 中定义的规范，Node Event Loop 是由 libuv 库实现

js 是单线程 

所谓单线程，是指在 JavaScript 引擎中负责解释和执行 JavaScript 代码的线程唯一，同一时间上只能执行一件任务

**为什么要引入单线程**

如果 JavaScript 引擎线程不是单线程的，那么可以同时执行多段 JavaScript，如果这多段 JavaScript 都修改 DOM，那么就会出现 DOM 冲突

引入单线程就意味着，所有任务需要排队，前一个任务结束，才会执行后一个任务。这同时又导致了一个问题：如果前一个任务耗时很长，后一个任务就不得不一直等着

为了解决这个问题，JavaScript 语言将任务的执行模式分为两种：同步和异步

**同步**

如果在函数 func 返回的时候，调用者就能够得到预期结果(即拿到了预期的返回值或者看到了预期的效果)，那么这个函数就是同步的。

    let a = 1
    Math.floor(a)
    console.log(a) // 1

**异步**

如果在函数 func 返回的时候，调用者还不能够得到预期结果，而是需要在将来通过一定的手段得到，那么这个函数就是异步的

    fs.readFile('foo.txt', 'utf8', function(err, data) {
        console.log(data);
    });

JavaScript 采用异步编程原因有两点，

* 一是 JavaScript 是单线程；
* 二是为了提高 CPU 的利用率

工作线程在异步操作完成后通知主线程，那么这个通知机制又是如何显现喃？答案就是就是消息队列与事件循环。

**消息队列与事件循环**

>工作线程将消息放在消息队列，主线程通过事件循环过程去取消息

  * 消息队列：消息队列是一个先进先出的队列，它里面存放着各种消息。
  * 事件循环：事件循环是指主线程重复从消息队列中取消息、执行的过程。

**事件循环（eventloop）**

主线程不断的从消息队列中取消息，执行消息，这个过程称为事件循环，这种机制叫事件循环机制，取一次消息并执行的过程叫一次循环

事件循环是JavaScript实现异步的具体解决方案，其中同步代码，直接执行；异步函数先放在异步队列中，待同步函数执行完毕后，轮询执行 异步队列 的回调函数。

**消息队列**
>消息就是注册异步任务时添加的回调函数